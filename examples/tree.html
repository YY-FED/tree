<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Title</title>
<link rel="stylesheet" href="../vendor/font-awesome/css/font-awesome.css">
<link rel="stylesheet" type="text/css" href="../vendor/uui/css/u.css">
<link rel="stylesheet" type="text/css" href="../vendor/uui/css/u-extend.css">
<link rel="stylesheet" type="text/css" href="../vendor/uui/css/tree.css">
<link rel="stylesheet" type="text/css" href="../vendor/uui/css/grid.css">
<style id="demo-style" media="screen">

</style>
</head>
<body>
<div class="demo">
    <div id="demoLeft"><div id="treeTest" class="ztree" u-meta='{"id":"tree2","data":"dataTable","type":"tree","idField":"id","pidField":"pid","nameField":"title","setting":"treeSetting"}'></div></div>
    <hr />
    <h4>dataTable操作</h4>
    <button type="button" class="u-button raised" id="addOneRow1">新增节点</button>
    <button type="button" class="u-button raised" id="deleteOneRow">删除节点</button> 
    <button type="button" class="u-button raised" id="deleteAllRows">删除全部节点</button>
</div>


<script src="../vendor/jquery/jquery-1.11.2.js"></script>
<script src="../vendor/knockout/knockout-3.2.0.debug.js"></script>
<script src="../vendor/uui/js/u-polyfill.js"></script>
<script src="../vendor/uui/js/u.js"></script>
<script src="../vendor/uui/js/u-tree.js"></script>
<script src="../vendor/uui/js/u-grid.js"></script>
<script src="../vendor/requirejs/require.debug.js"></script>
<script>
var viewModel = {
    treeSetting:{
        view:{
            showLine:false,
            selectedMulti:false
        },
        callback:{
            onClick:function(e,id,node){
                alert(id)
                alert(node)
            }
        },
        check: {
            enable: true,
            chkboxType:{ "Y" : "ps", "N" : "ps" }
        }
    },
    dataTable: new u.DataTable({
        meta: {
            'id': {
                'value':""
            },
            'pid': {
                'value':""
            },
            'title':{
                'value':""
            }
        }
    })
};
var app = u.createApp({
    el: '.demo',
    model: viewModel
})
var data = {
  "pageIndex": 1,
  "pageSize": 10,
  "rows": [
    {
      "status": "nrm",
      "data": {
        "id": "01",
        "pid": "root",
        "title": "f1"
      }
    },
    {
      "status": "nrm",
      "data": {
        "id": "02",
        "pid": "root",
        "title": "f2"
      }
    },
    {
      "status": "nrm",
      "data": {
        "id": "101",
        "pid": "01",
        "title": "f11"
      }
    },
    {
      "status": "nrm",
      "data": {
        "id": "102",
        "pid": "01",
        "title": "f12"
      }
    },
    {
      "status": "nrm",
      "data": {
        "id": "201",
        "pid": "02",
        "title": "f21"
      }
    }
  ]
}
viewModel.dataTable.setData(data);

var addOneRow1 = document.querySelector('#addOneRow1'),
    deleteOneRow = document.querySelector('#deleteOneRow'),
    deleteAllRows = document.querySelector('#deleteAllRows');
u.on(addOneRow1, "click",function(){
    var row={
        "status": "nrm",
        "data": {
            "id": "202",
            "pid": "02",
            "title": "f22"
        }};
    //先创建行模型，然后将数据插入行
    var r=new u.Row({parent:viewModel.dataTable});
    r.setData(row);
    //新增一行
    viewModel.dataTable.addRow(r);
});

u.on(deleteOneRow, "click",function(){
    var indices=viewModel.dataTable.getSelectedIndices();
    viewModel.dataTable.removeRows(indices)
});
u.on(deleteAllRows, "click",function(){
    viewModel.dataTable.removeAllRows();
})

</script>
</body>
</html>